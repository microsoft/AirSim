<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Image APIs - AirSim</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Image APIs";
    var mkdocs_page_input_path = "docs\\image_apis.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> AirSim</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../CHANGELOG/">Whats New</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Get AirSim</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../use_precompiled/">Download Binaries</a>
                </li>
                <li class="">
                    
    <a class="" href="../build_windows/">Build on Windows</a>
                </li>
                <li class="">
                    
    <a class="" href="../build_linux/">Build on Linux</a>
                </li>
                <li class="">
                    
    <a class="" href="../unreal_custenv/">Creating Custom Environment</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Using AirSim</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../apis/">Core APIs</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Image APIs</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#image-apis">Image APIs</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#getting-a-single-image">Getting a Single Image</a></li>
        
            <li><a class="toctree-l4" href="#getting-images-with-more-flexibility">Getting Images with More Flexibility</a></li>
        
            <li><a class="toctree-l4" href="#ready-to-run-complete-examples">Ready to Run Complete Examples</a></li>
        
            <li><a class="toctree-l4" href="#available-cameras">Available Cameras</a></li>
        
            <li><a class="toctree-l4" href="#computer-vision-mode_1">"Computer Vision" Mode</a></li>
        
            <li><a class="toctree-l4" href="#camera-apis">Camera APIs</a></li>
        
            <li><a class="toctree-l4" href="#changing-resolution-and-camera-parameters">Changing Resolution and Camera Parameters</a></li>
        
            <li><a class="toctree-l4" href="#what-does-pixel-values-mean-in-different-image-types">What Does Pixel Values Mean in Different Image Types?</a></li>
        
            <li><a class="toctree-l4" href="#example-code">Example Code</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../apis_cpp/">C++ APIs</a>
                </li>
                <li class="">
                    
    <a class="" href="../dev_workflow/">Development Workflow</a>
                </li>
                <li class="">
                    
    <a class="" href="../settings/">Settings</a>
                </li>
                <li class="">
                    
    <a class="" href="../camera_views/">Camera Views</a>
                </li>
                <li class="">
                    
    <a class="" href="../using_car/">Using Car</a>
                </li>
                <li class="">
                    
    <a class="" href="../remote_control/">Remote Control</a>
                </li>
                <li class="">
                    
    <a class="" href="../xbox_controller/">XBox Controller</a>
                </li>
                <li class="">
                    
    <a class="" href="../steering_wheel_installation/">Steering Wheel</a>
                </li>
                <li class="">
                    
    <a class="" href="../multi_vehicle/">Multiple Vehicles</a>
                </li>
                <li class="">
                    
    <a class="" href="../sensors/">Sensors</a>
                </li>
                <li class="">
                    
    <a class="" href="../lidar/">LIDAR</a>
                </li>
                <li class="">
                    
    <a class="" href="../ros/">ROS</a>
                </li>
                <li class="">
                    
    <a class="" href="../playback/">Playing Logs</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Design</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../design/">Architecture</a>
                </li>
                <li class="">
                    
    <a class="" href="../code_structure/">Code Structure</a>
                </li>
                <li class="">
                    
    <a class="" href="../coding_guidelines/">Coding Guidelines</a>
                </li>
                <li class="">
                    
    <a class="" href="../flight_controller/">Flight Controller</a>
                </li>
                <li class="">
                    
    <a class="" href="../simple_flight/">Simple Flight</a>
                </li>
                <li class="">
                    
    <a class="" href="../hello_drone/">Hello Drone</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">MavLink and PX4</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../px4_setup/">PX4 Setup for AirSim</a>
                </li>
                <li class="">
                    
    <a class="" href="../px4_sitl/">PX4 in SITL</a>
                </li>
                <li class="">
                    
    <a class="" href="https://youtu.be/1oY8Qu5maQQ">AirSim with Pixhawk</a>
                </li>
                <li class="">
                    
    <a class="" href="https://youtu.be/HNWdYrtw3f0">PX4 Setup with AirSim</a>
                </li>
                <li class="">
                    
    <a class="" href="https://www.youtube.com/watch?v=d_FyjKDWQfc&feature=youtu.be">Debugging Attitude Estimation</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/Microsoft/AirSim/wiki/Intercepting-MavLink-messages">Intercepting MavLink Messages</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/Microsoft/AirSim/wiki/Rapid-Descent-on-PX4-drones">Rapid Descent on PX4 Drones</a>
                </li>
                <li class="">
                    
    <a class="" href="../px4_build/">Building PX4</a>
                </li>
                <li class="">
                    
    <a class="" href="../px4_logging/">PX4/MavLink Logging</a>
                </li>
                <li class="">
                    
    <a class="" href="../log_viewer/">MavLink LogViewer</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Upgrading</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../unreal_upgrade/">Upgrading Unreal</a>
                </li>
                <li class="">
                    
    <a class="" href="../upgrade_apis/">Upgrading APIs</a>
                </li>
                <li class="">
                    
    <a class="" href="../upgrade_settings/">Upgrading Settings</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Contributed Tutorials</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../reinforcement_learning/">Reinforcement Learning</a>
                </li>
                <li class="">
                    
    <a class="" href="https://www.youtube.com/watch?v=y09VbdQWvQY">Using Environments from Marketplace</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/simondlevy/AirSimTensorFlow">Simple Collision Avoidance</a>
                </li>
                <li class="">
                    
    <a class="" href="https://aka.ms/AutonomousDrivingCookbook">Autonomous Driving on Azure</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/Microsoft/AirSim/wiki/hexacopter">Building Hexacopter</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/Microsoft/AirSim/wiki/moveOnPath-demo">Moving on Path Demo</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/Microsoft/AirSim/wiki/Point-Clouds">Building Point Clouds</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/Microsoft/AirSim/wiki/Implementing-a-Drone-Survey-script">Surveying Using Drone</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Misc</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../custom_drone/">AirSim on Real Drones</a>
                </li>
                <li class="">
                    
    <a class="" href="../cmake_linux/">Installing cmake on Linux</a>
                </li>
                <li class="">
                    
    <a class="" href="../hard_drive/">Tips for Busy HDD</a>
                </li>
                <li class="">
                    
    <a class="" href="../pfm/">pfm format</a>
                </li>
                <li class="">
                    
    <a class="" href="../unreal_proj/">Setting up Unreal Environment</a>
                </li>
                <li class="">
                    
    <a class="" href="../unreal_blocks/">Blocks Environment</a>
                </li>
                <li class="">
                    
    <a class="" href="../who_is_using/">Who is Using AirSim</a>
                </li>
                <li class="">
                    
    <a class="" href="../working_with_plugin_contents/">Working with UE Plugin Contents</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/Microsoft/AirSim/wiki/technion">Formula Student Technion Self-drive</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Support</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../faq/">FAQ</a>
                </li>
                <li class="">
                    
    <a class="" href="../../SUPPORT/">Support</a>
                </li>
                <li class="">
                    
    <a class="" href="../create_issue/">Create Issue</a>
                </li>
                <li class="">
                    
    <a class="" href="../../CONTRIBUTING/">Contribute</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">AirSim</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Using AirSim &raquo;</li>
        
      
    
    <li>Image APIs</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/microsoft/airsim/edit/master/docs/docs/image_apis.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="image-apis">Image APIs</h1>
<p>Please read <a href="../apis/">general API doc</a> first if you are not familiar with AirSim APIs.</p>
<h2 id="getting-a-single-image">Getting a Single Image</h2>
<p>Here's a sample code to get a single image from camera named "0". The returned value is bytes of png format image. To get uncompressed and other format as well as available cameras please see next sections.</p>
<h3 id="python">Python</h3>
<pre><code class="python">import airsim #pip install airsim

# for car use CarClient() 
client = airsim.MultirotorClient()

png_image = client.simGetImage(&quot;0&quot;, airsim.ImageType.Scene)
# do something with image
</code></pre>

<h3 id="c">C++</h3>
<pre><code class="cpp">#include &quot;vehicles/multirotor/api/MultirotorRpcLibClient.hpp&quot;

int getOneImage() 
{
    using namespace std;
    using namespace msr::airlib;

    //for car use CarRpcLibClient
    msr::airlib::MultirotorRpcLibClient client;

    vector&lt;uint8_t&gt; png_image = client.simGetImage(&quot;0&quot;, VehicleCameraBase::ImageType::Scene);
    //do something with images
}
</code></pre>

<h2 id="getting-images-with-more-flexibility">Getting Images with More Flexibility</h2>
<p>The <code>simGetImages</code> API which is slightly more complex to use than <code>simGetImage</code> API, for example, you can get left camera view, right camera view and depth image from left camera in a single API call. The <code>simGetImages</code> API also allows you to get uncompressed images as well as floating point single channel images (instead of 3 channel (RGB), each 8 bit).</p>
<h3 id="python_1">Python</h3>
<pre><code class="python">import airsim #pip install airsim

# for car use CarClient() 
client = airsim.MultirotorClient()

responses = client.simGetImages([
    # png format
    airsim.ImageRequest(0, airsim.ImageType.Scene), 
    # uncompressed RGBA array bytes
    airsim.ImageRequest(1, airsim.ImageType.Scene, False, False),
    # floating point uncompressed image
    airsim.ImageRequest(1, airsim.ImageType.DepthPlanner, True)])

 # do something with response which contains image data, pose, timestamp etc
</code></pre>

<h4 id="using-airsim-images-with-numpy">Using AirSim Images with NumPy</h4>
<p>If you plan to use numpy for image manipulation, you should get uncompressed RGBA image and then convert to numpy like this:</p>
<pre><code class="python">responses = client.simGetImages([ImageRequest(&quot;0&quot;, airsim.ImageType.Scene, False, False)])
response = responses[0]

# get numpy array
img1d = np.fromstring(response.image_data_uint8, dtype=np.uint8) 

# reshape array to 4 channel image array H X W X 4
img_rgba = img1d.reshape(response.height, response.width, 4)  

# original image is fliped vertically
img_rgba = np.flipud(img_rgba)

# just for fun add little bit of green in all pixels
img_rgba[:,:,1:2] = 100

# write to png 
airsim.write_png(os.path.normpath(filename + '.greener.png'), img_rgba) 
</code></pre>

<h4 id="quick-tips">Quick Tips</h4>
<ul>
<li>
<p>The API <code>simGetImage</code> returns <code>binary string literal</code> which means you can simply dump it in binary file to create a .png file. However if you want to process it in any other way than you can handy function <code>airsim.string_to_uint8_array</code>. This converts binary string literal to NumPy uint8 array.</p>
</li>
<li>
<p>The API <code>simGetImages</code> can accept request for multiple image types from any cameras in single call. You can specify if image is png compressed, RGB uncompressed or float array. For png compressed images, you get <code>binary string literal</code>. For float array you get Python list of float64. You can convert this float array to NumPy 2D array using
    <code>airsim.list_to_2d_float_array(response.image_data_float, response.width, response.height)</code>
    You can also save float array to .pfm file (Portable Float Map format) using <code>airsim.write_pfm()</code> function.</p>
</li>
</ul>
<h3 id="c_1">C++</h3>
<pre><code class="cpp">int getStereoAndDepthImages() 
{
    using namespace std;
    using namespace msr::airlib;

    typedef VehicleCameraBase::ImageRequest ImageRequest;
    typedef VehicleCameraBase::ImageResponse ImageResponse;
    typedef VehicleCameraBase::ImageType ImageType;

    //for car use
    //msr::airlib::CarRpcLibClient client;
    msr::airlib::MultirotorRpcLibClient client;

    //get right, left and depth images. First two as png, second as float16.
    vector&lt;ImageRequest&gt; request = { 
        //png format
        ImageRequest(&quot;0&quot;, ImageType::Scene),
        //uncompressed RGBA array bytes
        ImageRequest(&quot;1&quot;, ImageType::Scene, false, false),       
        //floating point uncompressed image  
        ImageRequest(&quot;1&quot;, ImageType::DepthPlanner, true) 
    };

    const vector&lt;ImageResponse&gt;&amp; response = client.simGetImages(request);
    //do something with response which contains image data, pose, timestamp etc
}
</code></pre>

<h2 id="ready-to-run-complete-examples">Ready to Run Complete Examples</h2>
<h3 id="python_2">Python</h3>
<p>For a more complete ready to run sample code please see <a href="https://github.com/Microsoft/AirSim/tree/master/PythonClient//multirotor/hello_drone.py">sample code in AirSimClient project</a> for multirotors or <a href="https://github.com/Microsoft/AirSim/tree/master/PythonClient//car/hello_car.py">HelloCar sample</a>. This code also demonstrates simple activities such as saving images in files or using <code>numpy</code> to manipulate images.</p>
<h3 id="c_2">C++</h3>
<p>For a more complete ready to run sample code please see <a href="https://github.com/Microsoft/AirSim/tree/master/HelloDrone//main.cpp">sample code in HelloDrone project</a> for multirotors or <a href="https://github.com/Microsoft/AirSim/tree/master/HelloCar//main.cpp">HelloCar project</a>. </p>
<p>See also <a href="https://github.com/Microsoft/AirSim/tree/master/Examples/DataCollection/StereoImageGenerator.hpp">other example code</a> that generates specified number of stereo images along with ground truth depth and disparity and saving it to <a href="../pfm/">pfm format</a>.</p>
<h2 id="available-cameras">Available Cameras</h2>
<h3 id="car">Car</h3>
<p>The cameras on car can be accessed by following names in API calls: <code>front_center</code>, <code>front_right</code>, <code>front_left</code>, <code>fpv</code> and <code>back_center</code>. Here FPV camera is driver's head position in the car.</p>
<h3 id="multirotor">Multirotor</h3>
<p>The cameras in CV mode can be accessed by following names in API calls: <code>front_center</code>, <code>front_right</code>, <code>front_left</code>, <code>bottom_center</code> and <code>back_center</code>. </p>
<h3 id="computer-vision-mode">Computer Vision Mode</h3>
<p>Camera names are same as in multirotor.</p>
<h3 id="backward-compatibility-for-camera-names">Backward compatibility for camera names</h3>
<p>Before AirSim v1.2, cameras were accessed using ID numbers instead of names. For backward compatibility you can still use following ID numbers for above camera names in same order as above: <code>"0"</code>, <code>"1"</code>, <code>"2"</code>, <code>"3"</code>, <code>"4"</code>. In addition, camera name <code>""</code> is also available to access the default camera which is generally the camera <code>"0"</code>.</p>
<h2 id="computer-vision-mode_1">"Computer Vision" Mode</h2>
<p>You can use AirSim in so-called "Computer Vision" mode. In this mode, physics engine is disabled and there is no vehicle, just cameras. You can move around using keyboard (use F1 to see help on keys). You can press Record button to continuously generate images. Or you can call APIs to move cameras around and take images.</p>
<p>To active this mode, edit <a href="../settings/">settings.json</a> that you can find in your <code>Documents\AirSim</code> folder (or <code>~/Documents/AirSim</code> on Linux) and make sure following values exist at root level:</p>
<pre><code class="json">{
  &quot;SettingsVersion&quot;: 1.2,
  &quot;SimMode&quot;: &quot;ComputerVision&quot;
}
</code></pre>

<p><a href="https://github.com/Microsoft/AirSim/tree/master/PythonClient//computer_vision/cv_mode.py">Here's the Python code example</a> to move camera around and capture images.</p>
<p>This mode was inspired from <a href="http://unrealcv.org/">UnrealCV project</a>.</p>
<h3 id="setting-pose-in-computer-vision-mode">Setting Pose in Computer Vision Mode</h3>
<p>To move around the environment using APIs you can use <code>simSetVehiclePose</code> API. This API takes position and orientation and sets that on the invisible vehicle where the front-center camera is located. All rest of the cameras move along keeping the relative position. If you don't want to change position (or orientation) then just set components of position (or orientation) to floating point nan values. The <code>simGetVehiclePose</code> allows to retrieve the current pose. You can also use <code>simGetGroundTruthKinematics</code> to get the quantities kinematics quantities for the movement. Many other non-vehicle specific APIs are also available such as segmentation APIs, collision APIs and camera APIs.</p>
<h2 id="camera-apis">Camera APIs</h2>
<p>The <code>simGetCameraInfo</code> returns the pose (in world frame, NED coordinates, SI units) and FOV (in degrees) for the specified camera. Please see <a href="https://github.com/Microsoft/AirSim/tree/master/PythonClient//computer_vision/cv_mode.py">example usage</a>.</p>
<p>The <code>simSetCameraOrientation</code> sets the orientation for the specified camera as quaternion in NED frame. The handy <code>airsim.to_quaternion()</code> function allows to convert pitch, roll, yaw to quaternion. For example, to set camera-0 to 15-degree pitch, you can use:</p>
<pre><code>client.simSetCameraOrientation(0, airsim.to_quaternion(0.261799, 0, 0)); #radians
</code></pre>

<h3 id="gimbal">Gimbal</h3>
<p>You can set stabilization for pitch, roll or yaw for any camera <a href="../settings/#gimbal">using settings</a>.</p>
<p>Please see <a href="https://github.com/Microsoft/AirSim/tree/master/PythonClient//computer_vision/cv_mode.py">example usage</a>.</p>
<h2 id="changing-resolution-and-camera-parameters">Changing Resolution and Camera Parameters</h2>
<p>To change resolution, FOV etc, you can use <a href="../settings/">settings.json</a>. For example, below addition in settings.json sets parameters for scene capture and uses "Computer Vision" mode described above. If you omit any setting then below default values will be used. For more information see <a href="../settings/">settings doc</a>. If you are using stereo camera, currently the distance between left and right is fixed at 25 cm.</p>
<pre><code class="json">{
  &quot;SettingsVersion&quot;: 1.2,
  &quot;CameraDefaults&quot;: {
      &quot;CaptureSettings&quot;: [
        {
          &quot;ImageType&quot;: 0,
          &quot;Width&quot;: 256,
          &quot;Height&quot;: 144,
          &quot;FOV_Degrees&quot;: 90,
          &quot;AutoExposureSpeed&quot;: 100,
          &quot;MotionBlurAmount&quot;: 0
        }
    ]
  },
  &quot;SimMode&quot;: &quot;ComputerVision&quot;
}
</code></pre>

<h2 id="what-does-pixel-values-mean-in-different-image-types">What Does Pixel Values Mean in Different Image Types?</h2>
<h3 id="available-imagetype-values">Available ImageType Values</h3>
<pre><code class="cpp">  Scene = 0, 
  DepthPlanner = 1, 
  DepthPerspective = 2,
  DepthVis = 3, 
  DisparityNormalized = 4,
  Segmentation = 5,
  SurfaceNormals = 6,
  Infrared = 7
</code></pre>

<h3 id="depthplanner-and-depthperspective">DepthPlanner and DepthPerspective</h3>
<p>You normally want to retrieve the depth image as float (i.e. set <code>pixels_as_float = true</code>) and specify <code>ImageType = DepthPlanner</code> or <code>ImageType = DepthPerspective</code> in <code>ImageRequest</code>. For <code>ImageType = DepthPlanner</code>, you get depth in camera plan, i.e., all points that are in plan parallel to camera have same depth. For <code>ImageType = DepthPerspective</code>, you get depth from camera using a projection ray that hits that pixel. Depending on your use case, planner depth or perspective depth may be the ground truth image that you want. For example, you may be able to feed perspective depth to ROS package such as <code>depth_image_proc</code> to generate a point cloud. Or planner depth may be more compatible with estimated depth image generated by stereo algorithms such as SGM.</p>
<h3 id="depthvis">DepthVis</h3>
<p>When you specify <code>ImageType = DepthVis</code> in <code>ImageRequest</code>, you get an image that helps depth visualization. In this case, each pixel value is interpolated from black to white depending on depth in camera plane in meters. The pixels with pure white means depth of 100m or more while pure black means depth of 0 meters.</p>
<h3 id="disparitynormalized">DisparityNormalized</h3>
<p>You normally want to retrieve disparity image as float (i.e. set <code>pixels_as_float = true</code> and specify <code>ImageType = DisparityNormalized</code> in <code>ImageRequest</code>) in which case each pixel is <code>(Xl - Xr)/Xmax</code>, which is thereby normalized to values between 0 to 1.</p>
<h3 id="segmentation">Segmentation</h3>
<p>When you specify <code>ImageType = Segmentation</code> in <code>ImageRequest</code>, you get an image that gives you ground truth segmentation of the scene. At the startup, AirSim assigns value 0 to 255 to each mesh available in environment. This value is than mapped to a specific color in <a href="https://github.com/Microsoft/AirSim/tree/master/Unreal//Plugins/AirSim/Content/HUDAssets/seg_color_pallet.png">the pallet</a>. The RGB values for each object ID can be found in <a href="../seg_rgbs.txt">this file</a>.</p>
<p>You can assign a specific value (limited to the range 0-255) to a specific mesh using APIs. For example, below Python code sets the object ID for the mesh called "Ground" to 20 in Blocks environment and hence changes its color in Segmentation view:</p>
<pre><code class="python">success = client.simSetSegmentationObjectID(&quot;Ground&quot;, 20);
</code></pre>

<p>The return value is a boolean type that lets you know if the mesh was found.</p>
<p>Notice that typical Unreal environments, like Blocks, usually have many other meshes that comprises of same object, for example, "Ground_2", "Ground_3" and so on. As it is tedious to set object ID for all of these meshes, AirSim also supports regular expressions. For example, the code below sets all meshes which have names starting with "ground" (ignoring case) to 21 with just one line:</p>
<pre><code class="python">success = client.simSetSegmentationObjectID(&quot;ground[\w]*&quot;, 21, True);
</code></pre>

<p>The return value is true if at least one mesh was found using regular expression matching.</p>
<p>It is recommended that you request uncompressed image using this API to ensure you get precise RGB values for segmentation image:</p>
<pre><code class="python">responses = client.simGetImages([ImageRequest(0, AirSimImageType.Segmentation, False, False)])
img1d = np.fromstring(response.image_data_uint8, dtype=np.uint8) #get numpy array
img_rgba = img1d.reshape(response.height, response.width, 4) #reshape array to 4 channel image array H X W X 4
img_rgba = np.flipud(img_rgba) #original image is fliped vertically

#find unique colors
print(np.unique(img_rgba[:,:,0], return_counts=True)) #red
print(np.unique(img_rgba[:,:,1], return_counts=True)) #green
print(np.unique(img_rgba[:,:,2], return_counts=True)) #blue  
</code></pre>

<p>A complete ready-to-run example can be found in <a href="https://github.com/Microsoft/AirSim/tree/master/PythonClient//computer_vision/segmentation.py">segmentation.py</a>.</p>
<h4 id="unsetting-object-id">Unsetting object ID</h4>
<p>An object's ID can be set to -1 to make it not show up on the segmentation image.</p>
<h4 id="how-to-find-mesh-names">How to Find Mesh Names?</h4>
<p>To get desired ground truth segmentation you will need to know the names of the meshes in your Unreal environment. To do this, you will need to open up Unreal Environment in Unreal Editor and then inspect the names of the meshes you are interested in using the World Outliner. For example, below we see the mesh names for he ground in Blocks environment in right panel in the editor:</p>
<p><img alt="record screenshot" src="../images/unreal_editor_blocks.png" /></p>
<p>If you don't know how to open Unreal Environment in Unreal Editor then try following the guide for <a href="../build_windows/">building from source</a>.</p>
<p>Once you decide on the meshes you are interested, note down their names and use above API to set their object IDs. There are <a href="../settings/#segmentation-settings">few settings</a> available to change object ID generation behavior.</p>
<h4 id="changing-colors-for-object-ids">Changing Colors for Object IDs</h4>
<p>At present the color for each object ID is fixed as in <a href="https://github.com/Microsoft/AirSim/tree/master/Unreal//Plugins/AirSim/Content/HUDAssets/seg_color_pallet.png">this palate</a>. We will be adding ability to change colors for object IDs to desired values shortly. In the meantime you can open the segmentation image in your favorite image editor and get the RGB values you are interested in.</p>
<h4 id="startup-object-ids">Startup Object IDs</h4>
<p>At the start, AirSim assigns object ID to each object found in environment of type <code>UStaticMeshComponent</code> or <code>ALandscapeProxy</code>. It then either uses mesh name or owner name (depending on settings), lower cases it, removes any chars below ASCII 97 to remove numbers and some punctuations, sums int value of all chars and modulo 255 to generate the object ID. In other words, all object with same alphabet chars would get same object ID. This heuristic is simple and effective for many Unreal environments but may not be what you want. In that case, please use above APIs to change object IDs to your desired values. There are <a href="../settings/#segmentation-settings">few settings</a> available to change this behavior.</p>
<h4 id="getting-object-id-for-mesh">Getting Object ID for Mesh</h4>
<p>The <code>simGetSegmentationObjectID</code> API allows you get object ID for given mesh name.</p>
<h3 id="infrared">Infrared</h3>
<p>Currently this is just a map from object ID to grey scale 0-255. So any mesh with object ID 42 shows up with color (42, 42, 42). Please see <a href="#segmentation">segmentation section</a> for more details on how to set object IDs. Typically noise setting can be applied for this image type to get slightly more realistic effect. We are still working on adding other infrared artifacts and any contributions are welcome.</p>
<h2 id="example-code">Example Code</h2>
<p>A complete example of setting vehicle positions at random locations and orientations and then taking images can be found in <a href="https://github.com/Microsoft/AirSim/tree/master/Examples/DataCollection/StereoImageGenerator.hpp">GenerateImageGenerator.hpp</a>. This example generates specified number of stereo images and ground truth disparity image and saving it to <a href="../pfm/">pfm format</a>.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../apis_cpp/" class="btn btn-neutral float-right" title="C++ APIs">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../apis/" class="btn btn-neutral" title="Core APIs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Copyright &copy; 2018 Microsoft Research</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/microsoft/airsim/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../apis/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../apis_cpp/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
